import numpy as np
from numpy import flipud
from random import sample

class Map():
    def __init__(self, map: np.ndarray, exits: list, start_points: list, random_exits:list, name, radius):
        # 对地图进行翻转操作
        map = flipud(map)
        self.map = map.T
        self.exits = exits
        self.start_points = start_points
        self.create_radius = radius
        self.name = name
        self.random_exits = random_exits

    def get_render_scale(self, window_size: int = 500):
        '''
        得到缩放比例，500*500的窗口大小
        :return:
        '''
        size = self.map.shape[0]
        return window_size / size

    def get_random_exit(self, index):
        return sample(self.random_exits[index], 1)[0]

    def __str__(self):
        return self.name


start_points_map2 = [(1.5, 3), (1.5, 8)]
exit_map2 = [(11.5, 2), (11.5, 9), (7, 11.5), (7, 0.5)]
radius_map2 = 1
random_exits2 = [[3], [4]]

map2 = np.array([
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
])

start_points_map4 = [(1.5, 3), (1.5, 8)]
exit_map4 = [(11.5, 9), (11.5, 2)]
radius_map4 = 1

map4 = np.array([
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
])

start_points_map5 = [(1.5, 3), (1.5, 8)]
exit_map5 = [(11.5, 2), (11.5, 9)]
radius_map5 = 1
random_exits5 = [[3], [4]]

#不进行交叉
map5 = np.array([
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
    [2, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 4],
    [2, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
])

start_points_map6 = [(1.5, 3), (1.5, 8)]
exit_map6 = [(11.5, 2), (11.5, 9)]
radius_map6 = 1
random_exits6 = [[3], [4]]

map6 = np.array([
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
    [2, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 4],
    [2, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 2],
    [2, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
])

start_points_map7 = [(2, 5.5), (9, 5.5)]
exit_map7 = [(11.5, 5.5), (0.5, 5.5)]
radius_map7 = 1.5

map7 = np.array([
    [2, 2, 2, 2, 5, 5, 5, 5, 2, 2, 2, 2],
    [2, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 2],
    [2, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 2],
    [2, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 2],
    [4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 2],
    [2, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 2],
    [2, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 2],
    [2, 2, 2, 2, 6, 6, 6, 6, 2, 2, 2, 2],
])

start_points_map8 = [(2, 5)]
exit_map8 = [(2, 11.5),(9, 11.5)]
radius_map8 = 1.5
random_exits8 = [[3, 4]]

map8 = np.array([
    [2, 3, 3, 3, 2, 2, 2, 2, 4, 4, 4, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 2],
    [2, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 2],
    [2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 2],
    [2, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 2],
    [2, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
])

start_points_map_hard = [(6.5, 2), (9, 6.5), (6.5, 9), (2, 6.5)]
exit_map_hard = [(6.5, 11.5), (0.5, 6.5), (6.5, 0.5), (11.5, 6.5)]
radius_map_hard = 1.5

map_hard = np.array([
    [2, 2, 2, 2, 2, 3, 3, 3, 2, 2, 2, 2],
    [2, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 2],
    [2, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 2],
    [2, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 2],
    [4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6],
    [4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6],
    [4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6],
    [2, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 2],
    [2, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 2],
    [2, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 2],
    [2, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 2],
    [2, 2, 2, 2, 2, 5, 5, 5, 2, 2, 2, 2],
])

exit_test_map = [(10, 3), (10, 7)]
start_points_test_map = [(4, 7),(4.5, 1),(2.125, 7),(4.5, 7),(6.0125, 7)]
radius_test_map = 0
test_map = np.array([
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 1, 1, 1, 1, 0, 0, 3],
    [2, 0, 0, 0, 0, 1, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 3],
    [2, 0, 0, 0, 0, 0, 0, 0, 0, 2],
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
])

map_02 = Map(map2, exit_map2, start_points_map2, random_exits2, "map_02", radius_map2)
#map_04 = Map(map4, exit_map4, start_points_map4, "map_04", radius_map4)
map_05 = Map(map5, exit_map5, start_points_map5, random_exits5, "map_05", radius_map5) #simple 1600 16 51.01min TD3
map_06 = Map(map6, exit_map6, start_points_map6, random_exits6, "map_06", radius_map6) #hard 1600 16 6 hour TD3
#map_07 = Map(map7, exit_map7, start_points_map7, "map_07", radius_map7) #mid 1600 16 4 hour TD3
map_08 = Map(map8, exit_map8, start_points_map8, random_exits8, "map_08", radius_map8) #
#map_test = Map(test_map, exit_test_map, start_points_test_map, "map_test", radius_test_map)
#map_hard_obj = Map(map_hard, exit_map7, start_points_map7, "map_07", radius_map7)